<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Khata Mitra</title>

<style>
body{
  font-family:Poppins, sans-serif;
  margin:0;
  background:#f5f5f5;
  padding:15px;
}

/* HEADER */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
h1{margin:0;color:#6a1b9a;}

.toggle{
  background:#222;
  color:#fff;
  padding:6px 12px;
  border-radius:8px;
  cursor:pointer;
}

/* DASHBOARD */
.dashboard{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  gap:12px;
  margin:15px 0;
}

.dCard{
  padding:15px;
  border-radius:14px;
  color:#fff;
  box-shadow:0 4px 12px rgba(0,0,0,.15);
  transition:.3s;
}

.dCard:hover{
  transform:translateY(-3px);
}

.dCard span{
  font-size:13px;
  opacity:.9;
}

.dCard h2{
  margin:5px 0 0;
  font-size:20px;
}

/* COLORS */
.purple{ background:linear-gradient(45deg,#6a1b9a,#9c27b0); }
.red{ background:linear-gradient(45deg,#e53935,#ef5350); }
.green{ background:linear-gradient(45deg,#2e7d32,#43a047); }
.blue{ background:linear-gradient(45deg,#1565c0,#1e88e5); }
.dark{ background:linear-gradient(45deg,#212121,#424242); }

#searchBox{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid #ddd;
  margin-bottom:10px;
  background:#fff;
}
  
  /* CARD */
.card{
  background:#fff;
  padding:12px;
  margin:8px 0;
  border-radius:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
  cursor:pointer;
}

/* ===== DETAIL PAGE ===== */
.detailPage{
  padding:15px;
  background:linear-gradient(135deg,#f3e5f5,#e3f2fd);
  min-height:100vh;
}

/* HEADER */
.detailHeader{
  background:linear-gradient(45deg,#6a1b9a,#9c27b0);
  padding:20px;
  border-radius:15px;
  color:#fff;
  text-align:center;
  box-shadow:0 4px 15px rgba(0,0,0,.2);
}

.balanceBox{
  font-size:18px;
  margin-top:5px;
  font-weight:bold;
}

/* ACTION BAR */
.actionBar{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin:15px 0;
}

/* BUTTONS PREMIUM */
.pdfBtn{
  background:linear-gradient(45deg,#ff9800,#ff5722);
}

.waBtn{
  background:linear-gradient(45deg,#25d366,#128c7e);
}

.backBtn{
  background:linear-gradient(45deg,#607d8b,#37474f);
}

.reminderBox{
  display:flex;
  align-items:center;
  gap:5px;
  background:#fff;
  padding:8px 10px;
  border-radius:10px;
  font-size:13px;
}

/* HISTORY TITLE */
.historyTitle{
  margin-top:20px;
  font-weight:bold;
  color:#333;
}

/* TABLE */
.tableWrap{
  overflow-x:auto;
}

.historyTable{
  width:100%;
  border-collapse:collapse;
  background:#fff;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 4px 15px rgba(0,0,0,.15);
}

.historyTable thead{
  background:linear-gradient(45deg,#1e88e5,#42a5f5);
  color:#fff;
}

.historyTable th,
.historyTable td{
  padding:10px;
  text-align:center;
  font-size:13px;
}

.historyTable tbody tr:nth-child(even){
  background:#f5f5f5;
}

.historyTable tbody tr:hover{
  background:#e3f2fd;
}

/* DELETE BUTTON */
.deleteBtn{
  background:#e53935;
  padding:5px 8px;
  font-size:12px;
  border-radius:6px;
}

  

/* FLOAT BTN */
.fab{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#0a84ff;
  color:#fff;
  font-size:26px;
  width:55px;
  height:55px;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
}

  /* NAV TABS */
.navTabs{
  display:flex;
  gap:6px;
  margin-bottom:10px;
}

.navBtn{
  flex:1;
  padding:10px;
  border:none;
  border-radius:10px;
  background:#eee;
  cursor:pointer;
}

.navBtn.active{
  background:#6a1b9a;
  color:#fff;
}

/* MAIN TAB */
.mainTab{ display:none; }
.mainTab.active{ display:block; }

  
/* DARK MODE */
.dark body{
  background:#121212;
  color:#fff;
}

.dark .card{
  background:#1e1e1e;
  color:#fff;
}

.dark input{
  background:#2a2a2a;
  color:#fff;
  border:1px solid #444;
}

.dark .navBtn{
  background:#2a2a2a;
  color:#fff;
}

.dark .navBtn.active{
  background:#0a84ff;
}
  

  #photoPreview, #galleryBox{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  max-height:250px;
  overflow:auto;
}
  .thumb{
  width:90px;
  height:90px;
  object-fit:cover;
  border-radius:10px;
}
.photoBox,.gItem{
  position:relative;
}
.delPhoto{
  position:absolute;
  top:2px;
  right:2px;
  background:red;
  color:#fff;
  border:none;
  border-radius:50%;
  width:20px;
  height:20px;
}
.gCap{
  font-size:11px;
  text-align:center;
}

  body{
  font-family:Poppins, sans-serif;
  background:#f5f5f5;
  margin:0;
  padding:15px;
}

/* TITLE */
h1{
  text-align:center;
  color:#6a1b9a;
  margin-bottom:15px;
}

/* CARD */
.card{
  background:#fff;
  padding:12px;
  margin:10px 0;
  border-radius:12px;
  box-shadow:0 3px 8px rgba(0,0,0,.12);
  cursor:pointer;
  transition:.2s;
}
.card:hover{ transform:scale(1.02); }

/* BUTTON */
button{
  background:#6a1b9a;
  color:#fff;
  border:none;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
  transition:.2s;
}
button:hover{ opacity:.9; }

/* BALANCE */
.balance-red{color:#e53935;font-weight:bold;}
.balance-green{color:#2e7d32;font-weight:bold;}

/* INPUT */
input,select{
  width:100%;
  margin:6px 0;
  padding:10px;
  border-radius:8px;
  border:1px solid #ddd;
  outline:none;
}
input:focus,select:focus{
  border-color:#6a1b9a;
  box-shadow:0 0 4px rgba(106,27,154,.3);
}

/* FLOATING BUTTON */
.fab{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#0a84ff;
  color:white;
  font-size:28px;
  width:55px;
  height:55px;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
  box-shadow:0 4px 12px rgba(0,0,0,.3);
  cursor:pointer;
  z-index:99;
}

/* BOTTOM SHEET */
.sheet{
  position:fixed;
  bottom:-100%;
  left:0;
  width:100%;
  height:70%;
  background:white;
  transition:.35s ease;
  border-radius:20px 20px 0 0;
  box-shadow:0 -4px 12px rgba(0,0,0,.25);
  z-index:100;
}
.sheet.active{ bottom:0; }
.sheet-content{ padding:15px; }

/* TABS */
.tabs{ display:flex; gap:10px; }
.tabs button{
  flex:1;
  background:#eee;
  color:#333;
}
.tabs button.active{
  background:#0a84ff;
  color:white;
}

/* TAB */
.tab{ display:none; margin-top:15px; }
.tab.active{ display:block; }

/* CLOSE */
.close{
  width:100%;
  margin-top:10px;
  padding:10px;
  background:#e53935;
  border-radius:10px;
}

/* THUMB */
.photoBox img,.gItem img{
  width:100%;
  height:90px;
  object-fit:cover;
  border-radius:8px;
  cursor:pointer;
}

/* DELETE BTN */
.delPhoto{
  position:absolute;
  top:3px;
  right:3px;
  background:red;
  color:#fff;
  border:none;
  border-radius:50%;
  width:18px;
  height:18px;
  font-size:12px;
  cursor:pointer;
}

/* ZOOM MODAL */
#zoomModal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}
#zoomModal img{
  max-width:95%;
  max-height:90%;
  border-radius:10px;
}

/* MOBILE */
@media(max-width:480px){
  body{ padding:10px; }
  .fab{ bottom:15px; right:15px; }
}
  
</style>
</head>

<body>

<div class="header">
  <h1>üìí Khata Mitra</h1>
  <div class="navTabs">
  <button class="navBtn active" onclick="openMainTab('home')">üè† Dashboard</button>
  <button class="navBtn" onclick="openMainTab('customers')">üë• Customers</button>
  <button class="navBtn" onclick="openMainTab('add')">‚ûï Add</button>
  <button class="navBtn" onclick="toggleDark()">üåô</button>
</div>
</div>

<div id="home" class="mainTab active">

  <div class="dashboard">

    <div class="dCard purple">
      <span>Total Customers</span>
      <h2 id="dCustomers">0</h2>
    </div>

    <div class="dCard red">
      <span>Total Udhar</span>
      <h2 id="dUdhar">0</h2>
    </div>

    <div class="dCard green">
      <span>Total Jama</span>
      <h2 id="dJama">0</h2>
    </div>

    <div class="dCard blue">
      <span>Total Items</span>
      <h2 id="dItems">0</h2>
    </div>

    <div class="dCard dark">
      <span>Net Balance</span>
      <h2 id="dBalance">0</h2>
    </div>

  </div>

</div>
  
<div id="customers" class="mainTab">

  <input id="searchBox" placeholder="üîç Search customer..." oninput="searchCustomer()">

  <div id="customerList"></div>

</div>
  
<div id="add" class="mainTab">

  <div class="card">
    <input id="customerName" placeholder="Customer Name">
    <input id="phone" placeholder="Phone Number">
    <button onclick="addCustomer()">Add Customer</button>
  </div>

</div>

<!-- Floating Add Button -->
<div class="fab" onclick="openSheet()">+</div>

<!-- Bottom Sheet -->
<div id="bottomSheet" class="sheet">
  <div class="sheet-content">
    
    <!-- Tabs -->
    <div class="tabs">
      <button onclick="openTab('manual')" class="active">Manual</button>
      <button onclick="openTab('items')">Items</button>
      <button onclick="openTab('upload')">Upload</button>
      <button onclick="openTab('gallery')">Gallery</button>
    </div>

    <!-- Manual -->
    <div id="manual" class="tab active">
      <select id="entryType">
        <option value="udhar">Udhar</option>
        <option value="jama">Jama</option>
      </select>

      <input type="number" id="custAmount" placeholder="Amount">
      <input type="text" id="custNote" placeholder="Note">

      <button onclick="addManualEntry()">Add Entry</button>
    </div>

    <!-- Items -->
    <div id="items" class="tab">
      <input type="text" id="itemName" placeholder="Item Name">
      <input type="number" id="itemPrice" placeholder="Price">
      <button onclick="addItem()">Add Item</button>
    </div>
    
    <!-- Upload -->
    <div id="upload" class="tab">
<input type="file" id="photoInput" accept="image/*">
<input type="text" id="photoCaption" placeholder="Photo caption">
<button onclick="savePhoto()">Save Photo</button>
<div id="photoPreview"></div>
    </div>
    
<div id="gallery" class="tab">
  <h3>üì∏ Customer Gallery</h3>
  <div id="galleryBox"></div>
</div>
    
    <button class="close" onclick="closeSheet()">Close</button>

  </div>
</div>
  
<!-- CUSTOMER DETAIL -->
  <div id="customers" class="mainTab">
<div id="customerDetail" class="detailPage">

  <div class="detailHeader">
    <h2 id="cName"></h2>
    <p class="balanceBox">
      Balance ‚Çπ <span id="cBalance"></span>
    </p>
  </div>

  <div class="actionBar">
    <button class="pdfBtn" onclick="exportPDF()">Export PDF</button>
    <button class="waBtn" onclick="sendReminder()">WhatsApp</button>

    <label class="reminderBox">
      <input type="checkbox" id="autoReminder">
      Auto Reminder
    </label>

    <button class="backBtn" onclick="closeCustomer()">Back</button>
  </div>

  <h3 class="historyTitle">Transaction History</h3>

  <div class="tableWrap">
    <table class="historyTable">
      <thead>
        <tr>
          <th>Type</th>
          <th>Amount</th>
          <th>Note</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="historyList"></tbody>
    </table>
  </div>

</div>
  </div>
  
<div id="zoomModal" style="
display:none;
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,.9);
justify-content:center;
align-items:center;
z-index:999;
">
  <img id="zoomImg" style="max-width:95%;max-height:95%;border-radius:10px">
</div>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="app.js"></script>

</body>
</html>
