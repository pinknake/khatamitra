<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Khata Mitra</title>
<style>
body{
  font-family:Poppins, sans-serif;
  background:#f5f5f5;
  margin:0;
  padding:15px;
}

/* TITLE */
h1{
  text-align:center;
  color:#6a1b9a;
  margin-bottom:15px;
}

/* CARD */
.card{
  background:#fff;
  padding:12px;
  margin:10px 0;
  border-radius:12px;
  box-shadow:0 3px 8px rgba(0,0,0,.12);
  cursor:pointer;
  transition:.2s;
}
.card:hover{
  transform:scale(1.02);
}

/* BUTTON */
button{
  background:#6a1b9a;
  color:#fff;
  border:none;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
  transition:.2s;
}
button:hover{
  opacity:.9;
}

/* BALANCE */
.balance-red{color:#e53935;font-weight:bold;}
.balance-green{color:#2e7d32;font-weight:bold;}

/* INPUT */
input,select{
  width:100%;
  margin:6px 0;
  padding:10px;
  border-radius:8px;
  border:1px solid #ddd;
  outline:none;
}
input:focus,select:focus{
  border-color:#6a1b9a;
  box-shadow:0 0 4px rgba(106,27,154,.3);
}

/* FLOATING BUTTON */
.fab{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#0a84ff;
  color:white;
  font-size:28px;
  width:55px;
  height:55px;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
  box-shadow:0 4px 12px rgba(0,0,0,.3);
  cursor:pointer;
  z-index:99;
}

/* BOTTOM SHEET */
.sheet{
  position:fixed;
  bottom:-100%;
  left:0;
  width:100%;
  height:70%;
  background:white;
  transition:.35s ease;
  border-radius:20px 20px 0 0;
  box-shadow:0 -4px 12px rgba(0,0,0,.25);
  z-index:100;
}
.sheet.active{ bottom:0; }

.sheet-content{ padding:15px; }

/* TABS */
.tabs{
  display:flex;
  gap:10px;
}
.tabs button{
  flex:1;
  background:#eee;
  color:#333;
}
.tabs button.active{
  background:#0a84ff;
  color:white;
}

/* TAB CONTENT */
.tab{ display:none; margin-top:15px; }
.tab.active{ display:block; }

/* CLOSE BUTTON */
.close{
  width:100%;
  margin-top:10px;
  padding:10px;
  background:#e53935;
  border-radius:10px;
}

/* HISTORY CARD */
#historyList .card{
  cursor:default;
}

/* MOBILE FIX */
@media(max-width:480px){
  body{ padding:10px; }
  .fab{ bottom:15px; right:15px; }
}
  #photoPreview{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  max-height:250px;
  overflow-y:auto;
}

.photoBox{
  position:relative;
}

.photoBox img{
  width:100%;
  height:90px;
  object-fit:cover;
  border-radius:8px;
  cursor:pointer;
}

.delPhoto{
  position:absolute;
  top:3px;
  right:3px;
  background:red;
  color:#fff;
  border:none;
  border-radius:50%;
  width:18px;
  height:18px;
  font-size:12px;
  cursor:pointer;
}
  #galleryBox{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  max-height:300px;
  overflow-y:auto;
}

.gItem{
  position:relative;
}

.gItem img{
  width:100%;
  height:90px;
  object-fit:cover;
  border-radius:8px;
}

.gCap{
  font-size:11px;
  text-align:center;
  margin-top:2px;
  color:#555;
}

.delPhoto{
  position:absolute;
  top:3px;
  right:3px;
  background:red;
  color:#fff;
  border:none;
  border-radius:50%;
  width:18px;
  height:18px;
  font-size:12px;
  cursor:pointer;
}
</style>
</head>

<body>

<h1>ðŸ“’ Khata Mitra</h1>

<div class="card">
  <input id="customerName" placeholder="Customer Name">
  <input id="phone" placeholder="Phone Number">
  <button onclick="addCustomer()">Add</button>
</div>

<div id="customerList"></div>

<!-- Floating Add Button -->
<div class="fab" onclick="openSheet()">+</div>

<!-- Bottom Sheet -->
<div id="bottomSheet" class="sheet">
  <div class="sheet-content">
    
    <!-- Tabs -->
    <div class="tabs">
      <button onclick="openTab('manual')" class="active">Manual</button>
      <button onclick="openTab('items')">Items</button>
      <button onclick="openTab('upload')">Upload</button>
      <button onclick="openTab('gallery')">Gallery</button>
    </div>

    <!-- Manual -->
    <div id="manual" class="tab active">
      <select id="entryType">
        <option value="udhar">Udhar</option>
        <option value="jama">Jama</option>
      </select>

      <input type="number" id="custAmount" placeholder="Amount">
      <input type="text" id="custNote" placeholder="Note">

      <button onclick="addManualEntry()">Add Entry</button>
    </div>

    <!-- Items -->
    <div id="items" class="tab">
      <input type="text" id="itemName" placeholder="Item Name">
      <input type="number" id="itemPrice" placeholder="Price">
      <button onclick="addItem()">Add Item</button>
    </div>
    
    <!-- Upload -->
    <div id="upload" class="tab">
<input type="file" id="photoInput" accept="image/*">
<input type="text" id="photoCaption" placeholder="Photo caption">
<button onclick="savePhoto()">Save Photo</button>
<div id="photoPreview"></div>
    </div>
    
<div id="gallery" class="tab">
  <h3>ðŸ“¸ Customer Gallery</h3>
  <div id="galleryBox"></div>
</div>
    
    <button class="close" onclick="closeSheet()">Close</button>

  </div>
</div>
  
<!-- CUSTOMER DETAIL -->
<div id="customerDetail" style="display:none">
  <h2 id="cName"></h2>
  <p>Balance: â‚¹ <span id="cBalance"></span></p>

  <h3>History</h3>
  <div id="historyList"></div>

  <button onclick="exportPDF()">ðŸ“„ Export PDF</button>

  <label>
    <input type="checkbox" id="autoReminder"> Auto WhatsApp Reminder
  </label>

  <button onclick="sendReminder()">ðŸ“² WhatsApp Reminder</button>
  <button onclick="closeCustomer()">â¬… Back</button>
</div>
<div id="zoomModal" style="
display:none;
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,.9);
justify-content:center;
align-items:center;
z-index:999;
">
  <img id="zoomImg" style="max-width:95%;max-height:95%;border-radius:10px">
</div>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="app.js"></script>

</body>
</html>
