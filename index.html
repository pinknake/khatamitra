<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Khata Mitra</title>

<style>
body{
  font-family:Poppins, sans-serif;
  margin:0;
  background:#f5f5f5;
  padding:15px;
}

/* HEADER */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
h1{margin:0;color:#6a1b9a;}

.toggle{
  background:#222;
  color:#fff;
  padding:6px 12px;
  border-radius:8px;
  cursor:pointer;
}

/* DASHBOARD */
.dashboard{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
  margin:15px 0;
}
.dCard{
  background:#fff;
  padding:12px;
  border-radius:12px;
  text-align:center;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}

/* SEARCH */
#search{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ddd;
  margin-bottom:10px;
}

/* CARD */
.card{
  background:#fff;
  padding:12px;
  margin:8px 0;
  border-radius:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
  cursor:pointer;
}

/* HISTORY TABLE */
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:8px;
  border-bottom:1px solid #ddd;
  text-align:left;
}
th{background:#eee}

/* FLOAT BTN */
.fab{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#0a84ff;
  color:#fff;
  font-size:26px;
  width:55px;
  height:55px;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* DARK MODE */
.dark{
  background:#111;
  color:#eee;
}
.dark .card,.dark .dCard{background:#1e1e1e}
.dark th{background:#222}

  #photoPreview, #galleryBox{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  max-height:250px;
  overflow:auto;
}
  .thumb{
  width:90px;
  height:90px;
  object-fit:cover;
  border-radius:10px;
}
.photoBox,.gItem{
  position:relative;
}
.delPhoto{
  position:absolute;
  top:2px;
  right:2px;
  background:red;
  color:#fff;
  border:none;
  border-radius:50%;
  width:20px;
  height:20px;
}
.gCap{
  font-size:11px;
  text-align:center;
}
  
</style>
</head>

<body>

<div class="header">
  <h1>ðŸ“’ Khata Mitra</h1>
  <div class="toggle" onclick="toggleDark()">ðŸŒ™</div>
</div>

<!-- DASHBOARD -->
<div class="dashboard">
  <div class="dCard">Customers<br><b id="dCustomers">0</b></div>
  <div class="dCard">Udhar<br><b id="dUdhar">0</b></div>
  <div class="dCard">Jama<br><b id="dJama">0</b></div>
</div>

<input id="search" placeholder="Search customer..." oninput="searchCustomer()">

<div class="card">
  <input id="customerName" placeholder="Customer Name">
  <input id="phone" placeholder="Phone Number">
  <button onclick="addCustomer()">Add</button>
</div>

<div id="customerList"></div>

<!-- Floating Add Button -->
<div class="fab" onclick="openSheet()">+</div>

<!-- Bottom Sheet -->
<div id="bottomSheet" class="sheet">
  <div class="sheet-content">
    
    <!-- Tabs -->
    <div class="tabs">
      <button onclick="openTab('manual')" class="active">Manual</button>
      <button onclick="openTab('items')">Items</button>
      <button onclick="openTab('upload')">Upload</button>
      <button onclick="openTab('gallery')">Gallery</button>
    </div>

    <!-- Manual -->
    <div id="manual" class="tab active">
      <select id="entryType">
        <option value="udhar">Udhar</option>
        <option value="jama">Jama</option>
      </select>

      <input type="number" id="custAmount" placeholder="Amount">
      <input type="text" id="custNote" placeholder="Note">

      <button onclick="addManualEntry()">Add Entry</button>
    </div>

    <!-- Items -->
    <div id="items" class="tab">
      <input type="text" id="itemName" placeholder="Item Name">
      <input type="number" id="itemPrice" placeholder="Price">
      <button onclick="addItem()">Add Item</button>
    </div>
    
    <!-- Upload -->
    <div id="upload" class="tab">
<input type="file" id="photoInput" accept="image/*">
<input type="text" id="photoCaption" placeholder="Photo caption">
<button onclick="savePhoto()">Save Photo</button>
<div id="photoPreview"></div>
    </div>
    
<div id="gallery" class="tab">
  <h3>ðŸ“¸ Customer Gallery</h3>
  <div id="galleryBox"></div>
</div>
    
    <button class="close" onclick="closeSheet()">Close</button>

  </div>
</div>
  
<!-- CUSTOMER DETAIL -->
<div id="customerDetail" style="display:none">
  <h2 id="cName"></h2>
  <p>Balance: â‚¹ <span id="cBalance"></span></p>

<h3>History</h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>Amount</th>
<th>Note</th>
<th>Date</th>
<th>Action</th>
</tr>
</thead>
<tbody id="historyList"></tbody>
</table>
  
  <div id="historyList"></div>

  <button onclick="exportPDF()">ðŸ“„ Export PDF</button>

  <label>
    <input type="checkbox" id="autoReminder"> Auto WhatsApp Reminder
  </label>

  <button onclick="sendReminder()">ðŸ“² WhatsApp Reminder</button>
  <button onclick="closeCustomer()">â¬… Back</button>
</div>
<div id="zoomModal" style="
display:none;
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,.9);
justify-content:center;
align-items:center;
z-index:999;
">
  <img id="zoomImg" style="max-width:95%;max-height:95%;border-radius:10px">
</div>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="app.js"></script>

</body>
</html>
